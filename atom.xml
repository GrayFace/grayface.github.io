-[
local SiteURL = "https://grayface.github.io/"
local URL = SiteURL.."`ru|ru/|"
local q = ({...})[2]
package.loaded.dataNews = nil
local news = require"dataNews"
local CurDate = "2018-06-14T02:45:02Z"
if news[#news].Date > CurDate then
	CurDate = news[#news].Date
end

--[[
local function GetDate()
	local t = os.date("!*t")
	return ("%d-%.2d-%.2dT%.2d:%.2d:%.2dZ"):format(t.year, t.month, t.day, t.hour, t.min, t.sec)
end
return GetDate()
]]

]<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="`en|en|`ru|ru|">
<title>`en|Sergey "GrayFace" Rozhenko Homepage|`ru|Сайт Сергея "GrayFace" Роженко|</title>
<subtitle>`en|News feed of my site.|`ru|Новостная лента моего сайта.|</subtitle>
<link href="$[URL]"/>
<link rel="self" href="$[URL]atom.xml"/>
<icon>$[SiteURL]favicon.ico</icon>
<logo>$[SiteURL]img/rss_logo.png</logo>
<id>$[URL]</id>
<author><name>`en|Sergey Rozhenko|`ru|Сергей Роженко|</name></author>
<updated>$[CurDate]</updated>
-[
local function item(t)
	t.Desc = t.Desc:gsub('<span class="change">', '<span style="white-space:nowrap;display:inline-block;margin-right:0.12em;">'):gsub('<span>', '<span style="display:inline-block;min-width:0.8em;text-align:center;">')
]
<entry>
<title>$[t.Title]</title>
<link href="$[URL]#$[t.Id]"/>
<updated>$[t.Date]</updated>
<id>$[URL]#$[t.Id]</id>
<summary type="html">
-[(t.Desc)
	local n = #q
	if t.Files[1] then
		]<div style="margin-top:0.5em;">-[
		for i, f in ipairs(t.Files) do
			]<div>-[
				CustomLink(f.URL, f.Info, f.MirrorSF)
				q[#q] = q[#q]:gsub('class="mirror"', 'style="margin-left:0.2em;margin-right:0.2em;"'):gsub('></a>', ' style="vertical-align:middle;height:1em;margin:-0.1em 0 0.1em;" height="13.6" width="13.6"></a>')
			]</div>-[
		end
		]</div>-[
	end
	-- escape it all
	for i = n, #q do
		q[i] = Escape(q[i]:gsub(" %- ([^%d])", " &ndash; %1"), 'main')
	end
]
</summary>
</entry>
-[
end

for i = #news, math.max(1, #news - 10), -1 do
	item(ProcessNewsItem(news[i]))
end
]
</feed>