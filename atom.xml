-[
local SiteURL = "https://grayface.github.io/"
local URL = SiteURL.."`ru|ru/|"
local q = ({...})[2]
package.loaded.dataNews = nil
local news = require"dataNews"
local CurDate = "2018-06-14T02:45:02Z"
if news[#news].Date > CurDate then
	CurDate = news[#news].Date
end

--[[
local function GetDate()
	local t = os.date("!*t")
	return ("%d-%.2d-%.2dT%.2d:%.2d:%.2dZ"):format(t.year, t.month, t.day, t.hour, t.min, t.sec)
end
return GetDate()
]]

]<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="`en|en|`ru|ru|">
<title>`en|Sergey "GrayFace" Rozhenko Homepage|`ru|Сайт Сергея "GrayFace" Роженко|</title>
<link href="$[URL]"/>
<link rel="self" href="$[URL]atom.xml"/>
<icon>$[SiteURL]favicon.ico</icon>
<logo>$[SiteURL]img/rss_logo.png</logo>
<id>$[URL]</id>
<author><name>`en|Sergey Rozhenko|`ru|Сергей Роженко|</name></author>
<updated>$[CurDate]</updated>
-[
local function item(t)
	local a = |s| ("`en|%s|`ru|%s|"):format(t[s], t[s.."RU"] or t[s])
	local desc = Escape(a"Desc", 'main')
	desc = desc:gsub("%[([%+%-%*])%] ", '<span style="white-space:nowrap;display:inline-block;margin-right:0.12em;">[<span !>%1</span>]</span> '):gsub("<span !>%-</span>", "<span !>&ndash;</span>"):gsub("<span !>", '<span style="display:inline-block;min-width:0.8em;text-align:center;">')
	local info = t.FileInfo or {}
	local infoRU = t.FileInfoRU or {}
	local files = t.Files or {}
	local mirrors = t.MirrorSF or {}
]
<entry>
<title>$[a"Title"]</title>
<link href="$[URL]#$[t.Id]"/>
<updated>$[t.Date]</updated>
<id>$[URL]#$[t.Id]</id>
<summary type="html">
-[(desc)
	local n = #q
	if not TitleURL and files[1] or files[2] then
		]<div style="margin-top:0.5em;">-[
		for i = 1, #files do
			local url = files[i]
			local fname = url:match("[^?]*"):match(".*/([^/]+)/?$")
			local en = info[i] or "Download "..fname
			local ru = infoRU[i] or "Скачать "..fname
			local desc = ("`en|%s|`ru|%s|"):format(en, ru)
			]<div>-[
				CustomLink(url, desc, mirrors[i])
				q[#q] = q[#q]:gsub('class="mirror"', 'style="margin-left:0.2em;margin-right:0.2em;"'):gsub('></a>', ' style="vertical-align:middle;height:1em;margin:-0.1em 0 0.1em;" height="13.6" width="13.6"></a>')
			]</div>-[
		end
		]</div>-[
	end
	-- escape it all
	for i = n, #q do
		q[i] = Escape(q[i], 'main')
	end
]
</summary>
</entry>
-[
end

for i = #news, math.max(1, #news - 10), -1 do
	item(news[i])
end
]
</feed>