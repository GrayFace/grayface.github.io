-[
SetTitle"`en|News|`ru|Новости|"
SetDescription"`en|Collection of my tools and patches for various games:|`ru|Мои утилиты и патчи для различных игр:| Might and Magic, Heroes, Knytt Stories, Elastomania."
]
<style>
	h3:not(#toc-header) {
		display: inline-block;
		margin-right: 0.7em;
		margin-bottom: 0.6em;
	}
	.change {
		white-space: nowrap;
	}
	.change span {
		display: inline-block;
		min-width: 0.8em;
		text-align: center;
	}
	.desc .change {
		display: inline-block;
		margin-right: 0.12em;
	}
	.date {
		margin-top: 0.35em;
		color: gray;
		font-size: 80%;
		padding-left: 2px;
	}
	article {
		margin: 1.3em 0 4px 10px;
	}
	.files {
		margin-top: 0.5em;
		padding-left: 1px;
	}
	#welcome {
		margin-top: 1.5em;
		font-size: 107%;
		padding-bottom: 0.1em;
	}
	.rss svg {
		height: 0.85em;
		margin: -0.05em 0.2em 0.2em 0.1em;
		vertical-align: bottom;
	}
</style>
<div id="welcome">
	`en|Welcome, travelers!|`ru|Добро пожаловать!|<br>
	<br>
	`en|Source code for all new releases can be found on Github|`ru|Исходники всех свежих релизов можно найти на Github'е| <a href="https://github.com/GrayFace/Misc">`en|here|`ru|здесь|</a> `en|or|`ru|или| <a href="https://github.com/GrayFace/MMExtension">`en|here|`ru|здесь|</a>. `en|New releases are easily distinguishable by the orange icon of SourceForge mirrors.|`ru|Такие релизы легко отличить по оранжевой иконке зеркала на SourceForge.|<br>
	<br>
	`en|To be notified about news you can subscribe to|`ru|Чтобы быть в курсе новостей, Вы можете подписаться на| <a class="rss" href="$[GetPath('atom.xml', PageId)]">-[(Include"svg/rss.svg")]RSS`en| Feed|</a>.<br>
	<br>
	`en|Below you can find all new releases (newest first).<br> <span class="change">[<span>+</span>]</span> means added feature, <span class="change">[<span>&ndash;</span>]</span> means fixed bug, <span class="change">[<span>*</span>]</span> means other changes.|
	`ru|Ниже идёт список всех новых релизов, отсортированный по дате.<br> <span class="change">[<span>+</span>]</span> означает новую фичу, <span class="change">[<span>&ndash;</span>]</span> означает исправленный баг, <span class="change">[<span>*</span>]</span> означает другое изменение.|
</div>
<div>
-[
package.loaded.dataNews = nil
local releases = require"dataNews"

local month = {"Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"}
local monthRU = {"января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"}

local function item(t)
	local a = |s| ("`en|%s|`ru|%s|"):format(t[s], t[s.."RU"] or t[s])
	local desc = Escape(a"Desc", 'main')
	desc = desc:gsub("%[([%+%-%*])%] ", '<span class="change">[<span>%1</span>]</span> '):gsub("<span>%-</span>", "<span>&ndash;</span>")
	local info = t.FileInfo or {}
	local infoRU = t.FileInfoRU or {}
	local files = t.Files or {}
	local mirrors = t.MirrorSF or {}
	local TitleURL = files[1] and not files[2] and not info[1] or t.TitleURL
	local y,m,d = t.Date:match("(%d+)-(%d+)-(%d+)")
	m = tonumber(m)
	local date = ("`en|%s %s, %s|`ru|%s %s %s|"):format(month[m], d, y, d, monthRU[m], y)
]
<article id="$[t.Id]">-[
	if TitleURL then
		]<h3>-[
			CustomLink(files[1], a"Title", mirrors[1])
		]</h3>-[
	else
		]<h3>$[a"Title"]</h3>-[
	end
	]<div class="desc">-[(desc)]</div>-[
	if not TitleURL and files[1] or files[2] then
		]<div class="files">-[
		for i = TitleURL and 2 or 1, #files do
			local url = files[i]
			local fname = url:match("[^?]*"):match(".*/([^/]+)/?$")
			local en = info[i] or "Download "..fname
			local ru = infoRU[i] or "Скачать "..fname
			local desc = ("`en|%s|`ru|%s|"):format(en, ru)
			]<div>-[
				CustomLink(url, desc, mirrors[i])
			]</div>-[
		end
		]</div>-[
	end
	]<div class="date">$[date]</div>
</article>
-[
end

for i = #releases, 1, -1 do
	item(releases[i])
end
]
</div>